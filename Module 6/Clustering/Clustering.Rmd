---
output:
  word_document: default
  html_document: default
---
#Ariel Romero

##Clustering Assignment

```{r}
options(tidyverse.quiet=TRUE)
library(tidyverse)
library(cluster)
library(factoextra)
library(dendextend)

trucks <- read_csv("trucks.csv")

str(trucks)
summary(trucks)
```

```{r}
ggplot(trucks, aes(x=Distance, y= Speeding)) +geom_point()
```

The relationship between Disance and Speeding seems to be non-linear with 4 potential clusters in the data. 

```{r}
trucks2 = select(trucks, Distance, Speeding)
trucks2_scaled =  as.data.frame(scale(trucks2))
summary(trucks2)
```

```{r}
set.seed(1234)

clusters1 <- kmeans(trucks2,2)

fviz_cluster(clusters1, trucks2_scaled)
```

It appears that the observations in the data sets do not share common characteristics. 

```{r}

set.seed(123)

fviz_nbclust(trucks2_scaled, kmeans, method = "wss")


```

```{r}
set.seed(123)
fviz_nbclust(trucks2_scaled,kmeans, method = "silhouette")
```

```{r}
set.seed(1234)

clusters1 <- kmeans(trucks2_scaled,4)
clusters1
fviz_cluster(clusters1, trucks2_scaled)
```

There are 4 very distinct groups clusters that share little to no characteristics with each other. It appearrs that clusters 2 and 4 may share a little. 

```{r}
wine <- read_csv("wineprice.csv")

wine2 = select(wine,Price,WinterRain,AGST,HarvestRain)

wine2_scaled = as.data.frame(scale(wine2))

summary(wine2_scaled)
```

```{r}
set.seed(123)
fviz_nbclust(wine2_scaled,kmeans, method = "wss")
fviz_nbclust(wine2_scaled,kmeans, method = "silhouette")
```

The consensus of the optimal amount of clusters from the two methods is 3. 
```{r}

set.seed(1234)

clusters2 <- kmeans(wine2_scaled,3)
clusters2
fviz_cluster(clusters2, wine2_scaled)

```

```{r}
m = c("average","single","complete", "ward")

names(m) = c("average", "single", "complete", "ward")

ac = function(x){
  
  agnes(wine2_scaled,method = x)$ac
}
map_dbl(m,ac)
```

```{r}


hc=agnes(wine2_scaled, method = "ward")
pltree(hc, cex=.6,hang =-1, main = "Agglomerative Dendogram")

```

```{r}
hc2 = diana(wine2_scaled)
pltree(hc2, cex=.6,hang =-1, main = "Divisive Dendogram")
```

