---
output:
  word_document: default
  html_document: default
---

Random Forest

Ariel Romero

```{r}
library(tidyverse)
library(caret)
library(ranger)
```

```{r}
Blood <- read_csv("Blood.csv")

Blood = Blood %>% mutate(DonatedMarch=as_factor(as.character(DonatedMarch))) %>% mutate(DonatedMarch = fct_recode(DonatedMarch, "No" = "0", "Yes" = "1"))

str(Blood)
```

```{r}
set.seed(1234)
train.rows = createDataPartition(y = Blood$DonatedMarch, p=0.7, list = FALSE)
train = Blood[train.rows,] 
test = Blood[-train.rows,]
```

```{r}
fit_control = trainControl(method = "cv",  
                           number = 10) 

set.seed(123)  
rf_fit = train(x=as.matrix(Blood[,-5]), y=as.matrix(Blood$DonatedMarch),
                 method = "ranger", 
                 importance = "permutation",
                 trControl = fit_control,num.trees = 100)
```

```{r}
varImp(rf_fit)
rf_fit
```

TotalDonation is the most important variable in the mode, Total_Donated is the least important. 

```{r}
predRF = predict(rf_fit, train)
head(predRF)
```

```{r}
confusionMatrix(predRF,train$DonatedMarch)
```

The accuracy is 89.69%, senesitiyvy is 58.40% and specificity is 99.50%. 

The accuracy is statistically signficant better than the naive. 

```{r}
predrf2 = predict(rf_fit,test)

head(predrf2)

confusionMatrix(predrf2, test$DonatedMarch)
```

The model performs almost exactly like it did for the training set. 

In the real world, this model could be used to predict who will be most likely to donate in March. This could prove useful in a case where there is a severe problem shortage to get a count of how many would donate blood. I would recommend this model for a high level prediction but for more granular information, there would have to more data provided in the dataset. 